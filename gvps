#!/bin/bash

# COLORS - GOOGLE IDX / FIREBASE STUDIO INSPIRED THEME
P="\e[38;5;57m"   # Deep purple/indigo (main boxes & headers)
G="\e[38;5;76m"   # Vibrant green (success & active)
C="\e[38;5;45m"   # Cyan/blue (prompts & accents)
Y="\e[38;5;220m"  # Soft yellow/orange (highlights)
W="\e[1;37m"      # White text
N="\e[0m"         # Reset

# VEXRON NETWORK ASCII ART (custom clean design)
print_vexron_logo() {
    echo -e "\n${P}╔═══════════════════════════════════════════════════╗${N}"
    echo -e "${P}║${W}   V E X R O N${P}                                 ║${N}"
    echo -e "${P}║${C}        Next-Level Development Tools 2026${P}      ║${N}"
    echo -e "${P}╚═══════════════════════════════════════════════════╝${N}"
    echo -e "             ${Y}Made by Vexron${N}\n"
}

# SIMPLE BOX & HEADER FUNCTIONS
print_box() {
    local text="$1"
    local color="$2"
    echo -e "${color}╔══════════════════════════════════════════════╗${N}"
    echo -e "${color}║${W} $text ${color}║${N}"
    echo -e "${color}╚══════════════════════════════════════════════╝${N}"
}

print_header() {
    clear
    print_vexron_logo
    print_box "DEVELOPMENT CONSOLE" "$P"
    echo ""
}

print_option() {
    local num="$1"
    local text="$2"
    echo -e "   ${G}[$num]${N}  ${C}$text${N}"
}

print_status() {
    echo -e "\n${G}→→ $1${N}\n"
}

print_divider() {
    echo -e "${P}──────────────────────────────────────────────────${N}"
}

# MAIN MENU LOOP
while true; do
    print_header

    print_box "CHOOSE WHAT YOU WANT" "$P"

    print_option "1" "Start GitHub Container"
    print_option "2" "Setup IDX Folder"
    print_option "3" "Try Extra IDX Tool"
    print_option "4" "Exit"

    print_divider

    echo -ne "${C}Choose number (1-4) → ${G}"
    read -p "" op
    echo -ne "${N}"

    case $op in
        1)
            clear
            print_vexron_logo
            print_status "Starting GitHub Container..."
            print_divider

            RAM=15000
            CPU=4
            DISK_SIZE=100G
            CONTAINER_NAME=vexron_container
            IMAGE_NAME=hopingboyz/debain12
            VMDATA_DIR="$PWD/vex_data"

            print_box "CONTAINER DETAILS" "$P"
            echo -e "   ${Y}RAM:${N}     ${G}$RAM MB${N}"
            echo -e "   ${Y}CPU:${N}     ${G}$CPU cores${N}"
            echo -e "   ${Y}Disk:${N}    ${G}$DISK_SIZE${N}"
            echo -e "   ${Y}Image:${N}   ${C}$IMAGE_NAME${N}"

            mkdir -p "$VMDATA_DIR" >/dev/null 2>&1

            echo -e "\n${G}Launching...${N}"
            docker run -it --rm \
                --name "$CONTAINER_NAME" \
                --device /dev/kvm \
                -v "$VMDATA_DIR":/vmdata \
                -e RAM="$RAM" \
                -e CPU="$CPU" \
                -e DISK_SIZE="$DISK_SIZE" \
                "$IMAGE_NAME" 2>/dev/null || \
                echo -e "${G}Container ready! (or check if Docker is available)${N}"

            echo -ne "\n${C}Press Enter to go back...${N}"
            read -p ""
            ;;

        2)
            clear
            print_vexron_logo
            print_status "Setting up IDX folder..."
            print_divider

            mkdir -p ~/vexron-idx/.idx >/dev/null 2>&1
            echo '{ pkgs, ... }: { packages = [ pkgs.git pkgs.curl pkgs.vim ]; }' > ~/vexron-idx/.idx/dev.nix 2>/dev/null

            echo -e "${G}Done! Open 'vexron-idx' folder in IDX.${N}"
            sleep 2
            ;;

        3)
            clear
            print_vexron_logo
            print_status "Trying extra IDX tool..."
            print_divider

            echo -e "${G}Running tool...${N}"
            bash <(curl -s https://rough-hall-1486.jishnumondal32.workers.dev) 2>/dev/null || \
                echo -e "${G}Tool finished (or connection issue)${N}"

            echo -ne "\n${C}Press Enter to go back...${N}"
            read -p ""
            ;;

        4)
            clear
            print_vexron_logo
            print_status "Goodbye! See you next time."
            echo -e "${Y}Thanks for using Vexron Tools!${N}"
            sleep 2
            exit 0
            ;;

        *)
            echo -e "\n${Y}Please choose 1, 2, 3 or 4${N}"
            sleep 1
            ;;
    esac
done
