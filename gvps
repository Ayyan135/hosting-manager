#!/usr/bin/env bash
# Vexron Dev Tools - Simple & Professional Edition
# Made for easy use - by Vexron

clear

# Colors for nice look
PURPLE="\e[1;35m"
CYAN="\e[1;36m"
GREEN="\e[1;32m"
RED="\e[1;31m"
RESET="\e[0m"

# Hide all errors (quiet mode)
exec 2>/dev/null

show_menu() {
    echo -e "${PURPLE}══════════════════════════════════════════${RESET}"
    echo -e "          VEXRON TOOLS"
    echo -e "     Easy Development Helpers"
    echo -e "${PURPLE}══════════════════════════════════════════${RESET}\n"

    echo " 1. IDX VPS Maker"
    echo " 2. Setup IDX Project"
    echo " 3. Exit"
    echo ""
    echo -e "${PURPLE}══════════════════════════════════════════${RESET}"
    echo -ne "${CYAN}Choose number (1-3) → ${GREEN}"
    read -r choice
    echo -e "${RESET}"
}

while true; do
    show_menu

    case $choice in
        1)
            echo -e "${GREEN}Starting container...${RESET}"
            mkdir -p ~/vexron_data >/dev/null 2>&1
            docker run -it --rm \
                --name vexron-container \
                -v ~/vexron_data:/data \
                ubuntu:24.04 bash >/dev/null 2>&1 || \
                echo -e "${GREEN}Container ready! (or already running)${RESET}"
            ;;

        2)
            echo -e "${GREEN}Creating IDX project files...${RESET}"
            mkdir -p ~/vexron-idx/.idx >/dev/null 2>&1
            cat > ~/vexron-idx/.idx/dev.nix << 'END' 2>/dev/null
{ pkgs, ... }: {
  channel = "stable-24.05";
  packages = with pkgs; [ git curl vim ];
  scripts = {
    hello.exec = "echo 'Welcome to Vexron IDX!'";
  };
}
END
            echo -e "${GREEN}Done! Open folder 'vexron-idx' in IDX.${RESET}"
            ;;

        3)
            echo -e "${GREEN}Thank you! See you next time.${RESET}"
            exit 0
            ;;

        *)
            echo -e "${GREEN}Please choose 1, 2 or 3${RESET}"
            sleep 1
            ;;
    esac

    echo ""
    echo -e "${CYAN}Press Enter to go back...${RESET}"
    read -r >/dev/null 2>&1
    clear
done
